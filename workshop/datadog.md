## Datadog新機能アレコレまとめて一挙ご紹介

### 基本機能のおさらい

#### Datadogってなに？
運用と開発の二人のエンジニアが立ち上げた。
DevOpsのコラボレーションツールとして生まれた。

#### 特徴
- リアルタイムパフォーマンス監視
- アラート
- 履歴分析
- トラブルシュートするためのDashboard
- SaaS

#### 可視化するための三本柱

##### Traces
サービス間の原因特定
アプリのスループットレイテンシ、エラー
リクエストベース

##### Metrics
トレンドやパターン把握

##### Logs

#### モニタリングの領域
- メトリクス
- ログ
- トランザクショントレース
  - トータルトランザクション（Web, App, DB）の追跡

#### モニタリングツール系統別のカバー範囲

##### RUM
- ブラウザとJSログを分析できる

##### APM
- トレーシングライブラリ入れる

##### Synthetics
- 外形監視、E2E

##### Infrastructure & Log Management
- ログを収集するだけじゃなく、分析をちゃんとしよう
- Datadogは上記を一気通貫で見て横断分析ができる
- 自動的にタグ付けされたデータが生成される

##### サービスマップ
- 依存関係が可視化できるポータルを生成する

##### その他
- 機械学習監視もできる
- CI/CDツールと連携することで、各パイプラインの変更イベントも収集して監視できる

#### クラウド時代の監視ポイントは？
タグ（ラベル）ごとにモニタリングや相関関係を可視化して多次元で監視する

詳しくは過去資料見てね

### 新機能

#### 外形監視
- GETアクセスする
- リダイレクト監視もできる

#### E2E Test
- ブラウザテスト
- Seleniumに変わり、GUIのクリック操作でシナリオ作成できる
- デザイナーも使いやすい
- SLOウィジェットでサービスレベル目標を可視化できる
- エラーバジェットも計算や表示ができる

#### APM
- PHPと.netがGA
- メジャー言語は基本的にサポートしている

#### Cloud Run

#### その他
- Stackdriver logsも取り込める
- Hangoutもできる
- Alibabaもできる
- AIX用Daadogエージェントもリリースした

## DatadogにTerraformをあげましょう

### Hashicorpサービスの紹介

#### Consul
- サービスがホストベースからサービスベースに移行している
- 全てのアプリケーションをサービスメッシュでコネクトする
- ServiceDiscovery
- サービス間通信の制御をサイドカープロキシをmTLSコネクションでまかなう
- 内部にKVSがある
- リアルタイムで環境変数やenvの設定変更ができる

#### Nomad
- 密結合から疎結合に移行している
- 特定アプリをマルチクラウドで動かしたい・・・など
- 状態保持を実行し続ける
- CPUのアイドル時間をへらす

#### Vault
- IPベースからIdentityベースに移行している
- LDAPやADなどの認証基盤を使ってTokenを発行し、Secretや証明書を管理して提供する
- 動的シークレットも得意
  - 30分だけ有効なシークレットなど
  - DBへの一時アクセスなど

#### Terraform
- 様々なインフラへのプロビジョニング

### 立ち上げたあとの監視はどうするの？
- DatadogでVaultやConsulを監視できる
- DogStatsD

### Dashboardはどうするの？
- TerraformでDatadog providerを使うとコード化できる
- timeboardの作成